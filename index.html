<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Monitorowanie Węzła Algorand</title>
  <style>
    body {
      background-color: #0f0f0f;
      color: #d0a8ff;
      font-family: monospace;
      text-align: center;
    }
    input, button {
      margin: 5px;
      font-family: monospace;
    }
    .status-active {
      color: limegreen;
    }
    .status-inactive {
      color: red;
    }
  </style>
</head>
<body>
  <h1>Monitorowanie Węzła Algorand</h1>
  <input type="text" id="account" placeholder="Wpisz adres portfela Algorand" />
  <button onclick="fetchData()">Sprawdź</button>

  <h2>Status Węzła</h2>
  <div id="node-status" class="status-inactive">Loading...</div>

  <h2>Czas od ostatniego bloku</h2>
  <div id="last-block">Loading...</div>

  <script>
    const API_BASE = "https://algo-monitor.onrender.com"; // Twój backend

    function fetchData() {
      let account = document.getElementById("account").value;
      fetch(`${API_BASE}/node-account?account=${account}`)
        .then((response) => response.json())
        .then((data) => {
          let statusElement = document.getElementById("node-status");

          // Jeśli registered-for-rewards = true → RUNNING
          if (data.account["registered-for-rewards"]) {
            statusElement.innerText = "RUNNING";
            statusElement.classList.remove("status-inactive");
            statusElement.classList.add("status-active");
          } else {
            statusElement.innerText = "INACTIVE";
            statusElement.classList.remove("status-active");
            statusElement.classList.add("status-inactive");
          }
        })
        .catch((error) => {
          document.getElementById("node-status").innerText = "Błąd: " + error;
        });
    }

    function updateLastBlock() {
      fetch(`${API_BASE}/last-round`)
        .then((response) => response.json())
        .then((data) => {
          document.getElementById("last-block").innerText = `Ostatni blok: ${data.last_round}`;
        })
        .catch(() => {
          document.getElementById("last-block").innerText = "Błąd pobierania bloku";
        });
    }

    setInterval(updateLastBlock, 5000);
    updateLastBlock(); // Pierwsze wywołanie od razu
  </script>
</body>
</html>
